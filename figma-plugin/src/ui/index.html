<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forge</title>
  <style>
    :root {
      --bg: #2c2c2c;
      --bg-input: #1e1e1e;
      --text: #ffffff;
      --text-secondary: #b3b3b3;
      --text-muted: #808080;
      --accent: #0d99ff;
      --accent-hover: #0b86e0;
      --success: #14ae5c;
      --error: #f24822;
      --border: #404040;
      --radius: 8px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      font-size: 12px;
      color: var(--text);
      background: var(--bg);
      line-height: 1.4;
    }

    .app { padding: 16px; display: flex; flex-direction: column; gap: 16px; }

    .header { display: flex; align-items: baseline; gap: 8px; }
    .header h1 { font-size: 16px; font-weight: 700; }
    .version { font-size: 11px; color: var(--text-muted); }

    .input-section { display: flex; flex-direction: column; gap: 8px; }
    .input-label { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-secondary); }
    .json-size { color: var(--text-muted); }

    .json-input {
      width: 100%;
      min-height: 120px;
      padding: 10px;
      background: var(--bg-input);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-family: "SF Mono", "Fira Code", monospace;
      font-size: 11px;
      resize: vertical;
      outline: none;
    }
    .json-input:focus { border-color: var(--accent); }
    .json-input::placeholder { color: var(--text-muted); }

    .actions { display: flex; gap: 8px; }

    .btn-paste {
      flex: 1;
      padding: 8px;
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 12px;
    }
    .btn-paste:hover { background: var(--bg-input); border-color: var(--text-muted); }

    .btn-import {
      flex: 2;
      padding: 8px 16px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: var(--radius);
      font-weight: 600;
      font-size: 12px;
      cursor: pointer;
    }
    .btn-import:hover:not(:disabled) { background: var(--accent-hover); }
    .btn-import:disabled { opacity: 0.4; cursor: not-allowed; }

    .validation-error { color: var(--error); font-size: 11px; }

    /* Progress */
    .progress-section { display: flex; flex-direction: column; gap: 10px; padding: 20px 0; }
    .progress-phase { font-size: 13px; font-weight: 500; }
    .progress-bar { height: 6px; background: var(--bg-input); border-radius: 3px; overflow: hidden; }
    .progress-fill { height: 100%; background: var(--accent); border-radius: 3px; transition: width 0.2s; }
    .progress-detail { font-size: 11px; color: var(--text-muted); }

    /* Result */
    .result-section { text-align: center; padding: 20px 0; display: flex; flex-direction: column; align-items: center; gap: 12px; }
    .result-icon { width: 48px; height: 48px; border-radius: 50%; background: var(--success); color: white; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; }
    .result-title { font-size: 16px; font-weight: 600; }
    .result-stats { display: flex; gap: 24px; }
    .stat { display: flex; flex-direction: column; align-items: center; gap: 2px; }
    .stat-value { font-size: 20px; font-weight: 700; color: var(--accent); }
    .stat-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

    .btn-reset {
      padding: 8px 24px;
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 12px;
    }
    .btn-reset:hover { background: var(--bg-input); }

    /* Error */
    .error-section { text-align: center; padding: 20px 0; display: flex; flex-direction: column; align-items: center; gap: 12px; }
    .error-icon { width: 48px; height: 48px; border-radius: 50%; background: var(--error); color: white; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; }
    .error-title { font-size: 16px; font-weight: 600; }
    .error-message { font-size: 12px; color: var(--text-secondary); max-width: 300px; word-break: break-word; }

    /* Token Panel */
    .token-panel { border-top: 1px solid var(--border); padding-top: 12px; width: 100%; text-align: left; }
    .token-panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .token-panel-title { font-size: 12px; font-weight: 600; }
    .token-panel-count { font-size: 11px; color: var(--text-muted); }

    .token-section { margin-bottom: 4px; }
    .token-section-header {
      display: flex; align-items: center; gap: 4px; width: 100%;
      background: none; border: none; color: var(--text-secondary);
      font-size: 11px; cursor: pointer; padding: 4px 0;
    }
    .token-section-header:hover { color: var(--text); }
    .token-section-arrow { font-size: 10px; width: 12px; }
    .token-section-title { flex: 1; text-align: left; }
    .token-section-count { color: var(--text-muted); font-size: 10px; }

    .token-section-body { padding: 4px 0 8px 16px; }

    .token-color-grid { display: flex; flex-wrap: wrap; gap: 6px; }
    .token-color-item { display: flex; align-items: center; gap: 4px; }
    .token-color-swatch { width: 14px; height: 14px; border-radius: 3px; border: 1px solid var(--border); flex-shrink: 0; }
    .token-color-name { font-size: 10px; color: var(--text-muted); max-width: 80px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    .token-list { display: flex; flex-direction: column; gap: 3px; }
    .token-list-item { display: flex; justify-content: space-between; align-items: center; gap: 8px; }
    .token-item-name { font-size: 10px; color: var(--text-secondary); flex-shrink: 0; }
    .token-item-detail { font-size: 10px; color: var(--text-muted); text-align: right; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .token-var-type { display: inline-block; background: var(--bg-input); padding: 0 4px; border-radius: 3px; font-size: 9px; margin-right: 4px; }

    /* Component Panel */
    .component-panel { border-top: 1px solid var(--border); padding-top: 8px; width: 100%; text-align: left; }
    .component-panel-header {
      display: flex; align-items: center; gap: 4px; width: 100%;
      background: none; border: none; color: var(--text-secondary);
      font-size: 12px; cursor: pointer; padding: 4px 0;
    }
    .component-panel-header:hover { color: var(--text); }
    .component-panel-title { flex: 1; text-align: left; font-weight: 600; }
    .component-panel-count { font-size: 11px; color: var(--text-muted); }
    .component-panel-body { padding: 6px 0 4px 16px; display: flex; flex-direction: column; gap: 4px; }
    .component-item { display: flex; align-items: center; gap: 6px; }
    .component-item-icon { font-size: 10px; color: var(--accent); flex-shrink: 0; }
    .component-item-name { font-size: 11px; color: var(--text-secondary); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .component-item-count { font-size: 10px; color: var(--text-muted); flex-shrink: 0; }

    /* Relay */
    .relay-status { width: 8px; height: 8px; border-radius: 50%; background: var(--text-muted); margin-left: auto; }
    .relay-status.relay-connected { background: var(--success); }
    .btn-relay {
      flex: 1; padding: 8px;
      background: transparent; color: var(--text-secondary);
      border: 1px solid var(--border); border-radius: var(--radius);
      cursor: pointer; font-size: 12px;
    }
    .btn-relay:hover { background: var(--bg-input); border-color: var(--text-muted); }
    .btn-reimport {
      flex: 1; padding: 8px;
      background: transparent; color: var(--accent);
      border: 1px solid var(--accent); border-radius: var(--radius);
      cursor: pointer; font-size: 12px;
    }
    .btn-reimport:hover { background: rgba(13, 153, 255, 0.1); }

    /* Diff Panel */
    .diff-panel { display: flex; flex-direction: column; gap: 12px; }
    .diff-header h2 { font-size: 14px; font-weight: 600; margin-bottom: 6px; }
    .diff-summary { display: flex; flex-wrap: wrap; gap: 6px; }
    .diff-badge { font-size: 11px; padding: 2px 8px; border-radius: 12px; }
    .diff-badge--modified { background: rgba(255, 205, 41, 0.15); color: #ffcd29; }
    .diff-badge--added { background: rgba(20, 174, 92, 0.15); color: #14ae5c; }
    .diff-badge--removed { background: rgba(242, 72, 34, 0.15); color: #f24822; }
    .diff-badge--unchanged { background: rgba(128, 128, 128, 0.15); color: var(--text-muted); }

    .diff-list { max-height: 300px; overflow-y: auto; display: flex; flex-direction: column; gap: 2px; }
    .diff-item { display: flex; align-items: center; gap: 6px; padding: 4px 6px; border-radius: 4px; cursor: pointer; font-size: 11px; }
    .diff-item:hover { background: var(--bg-input); }
    .diff-item input[type="checkbox"] { flex-shrink: 0; }
    .diff-type-icon { width: 16px; height: 16px; display: flex; align-items: center; justify-content: center; border-radius: 3px; font-size: 12px; font-weight: 700; flex-shrink: 0; }
    .diff-type-icon--modified { background: rgba(255, 205, 41, 0.2); color: #ffcd29; }
    .diff-type-icon--added { background: rgba(20, 174, 92, 0.2); color: #14ae5c; }
    .diff-type-icon--removed { background: rgba(242, 72, 34, 0.2); color: #f24822; }
    .diff-item-desc { flex: 1; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .diff-item-path { font-size: 9px; color: var(--text-muted); font-family: monospace; flex-shrink: 0; }

    .diff-actions { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn-apply { flex: 2; padding: 8px; background: var(--accent); color: white; border: none; border-radius: var(--radius); font-weight: 600; font-size: 12px; cursor: pointer; }
    .btn-apply:hover:not(:disabled) { background: var(--accent-hover); }
    .btn-apply:disabled { opacity: 0.4; cursor: not-allowed; }
    .btn-full-reimport { flex: 1; padding: 8px; background: transparent; color: var(--text-secondary); border: 1px solid var(--border); border-radius: var(--radius); font-size: 12px; cursor: pointer; }
    .btn-full-reimport:hover { background: var(--bg-input); }
    .btn-cancel { flex: 1; padding: 8px; background: transparent; color: var(--text-muted); border: 1px solid var(--border); border-radius: var(--radius); font-size: 12px; cursor: pointer; }
    .btn-cancel:hover { background: var(--bg-input); }
  </style>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="ui.js"></script>
</body>
</html>
